<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WELCOME TO THE POSH TRAINING</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 100px;
      background: #f9f9f9;
    }
    h1 {
      margin-bottom: 40px;
    }
    input, button {
      padding: 15px 30px;
      font-size: 18px;
      margin: 10px;
      width: 300px;
      border-radius: 8px;
    }
    button {
      background: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>WELCOME TO THE POSH TRAINING</h1>
  <p id="user-info">Loading...</p>

  <div id="details-section">
    <p id="shop-details"></p>
    <button id="confirm-btn">Yes, this is correct</button>
  </div>

  <div id="confirmation-section" style="display: none;">
    <p id="confirmation-msg"></p>
    <p>Your Shop ID (Password): <span id="shop-id"></span></p>
    <button id="go-to-links-btn">Proceed to the Training Links</button>
  </div>

  <div id="final-section" style="display: none;">
    <button id="btn-employer">Go to Employer Training</button>
    <button id="btn-employee">Go to Employee Training</button>
  </div>

  <script>
    // Simulated data from your uploaded Excel (Shop ID, Shop Name, Market Name)
    const shopData = [
      { shopid: 17324, shopname: "fabindia", marketname: "khan market" },
      { shopid: 15647, shopname: "nicobar", marketname: "vasant vihar" },
      { shopid: 76845, shopname: "eleved", marketname: "malcha marg" },
      { shopid: 88974, shopname: "nappa dori", marketname: "vasabt vihar" },
      { shopid: 44346, shopname: "evergreen", marketname: "julena" }
    ];

    // Get shopid from the URL
    const params = new URLSearchParams(window.location.search);
    const shopIdFromUrl = parseInt(params.get("shopid")); // Get the shopid from the URL
    const userInfo = document.getElementById("user-info");
    const shopDetails = document.getElementById("shop-details");
    const confirmationMsg = document.getElementById("confirmation-msg");
    const shopIdElement = document.getElementById("shop-id");
    const detailsSection = document.getElementById("details-section");
    const confirmationSection = document.getElementById("confirmation-section");
    const finalSection = document.getElementById("final-section");

    // Find the shop details based on the shopid in the URL
    const shop = shopData.find(shop => shop.shopid === shopIdFromUrl);
    if (shop) {
      shopDetails.innerText = `Shop: ${shop.shopname} | Market: ${shop.marketname}`;
      detailsSection.style.display = "block";
    } else {
      userInfo.innerText = "Shop not found!";
    }

    // Handle confirmation button click
    document.getElementById("confirm-btn").onclick = () => {
      // Generate a Shop ID (password) from the shopid
      const shopId = `SHOP-${shop.shopid}`;

      // Display confirmation message
      confirmationMsg.innerText = `You entered: Shop: ${shop.shopname} | Market: ${shop.marketname}. Is this correct?`;
      shopIdElement.innerText = shopId;

      detailsSection.style.display = "none";
      confirmationSection.style.display = "block";
    };

    // Scroll to final section and show AdPuzzle links
    document.getElementById("go-to-links-btn").onclick = () => {
      finalSection.style.display = "block";
      window.scrollTo(0, document.body.scrollHeight); // Scroll to the final buttons section
    };

    // Handle button clicks (redirect to AdPuzzle classrooms)
    const classroom1Link = "https://edpuzzle.com/assignments/68b1a7f9ddde8cb5f8362210/watch";
    const classroom2Link = "https://edpuzzle.com/assignments/68b1a7f9ddde8cb5f8362210/watch"; // Update this link

    document.getElementById("btn-employer").onclick = () => {
      window.location.href = `${classroom1Link}?shop=${shop.shopname}&market=${shop.marketname}&shopid=${shop.shopid}`;
      trackUserDetails(shop.shopname, shop.marketname, "Employer");
    };

    document.getElementById("btn-employee").onclick = () => {
      window.location.href = `${classroom2Link}?shop=${shop.shopname}&market=${shop.marketname}&shopid=${shop.shopid}`;
      trackUserDetails(shop.shopname, shop.marketname, "Employee");
    };

    // Track user details (send to backend)
    function trackUserDetails(shopName, marketName, role) {
      fetch("https://your-backend-url.com/track", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ shopName, marketName, role, timestamp: new Date().toISOString() })
      });
    }
  </script>
</body>
</html>
